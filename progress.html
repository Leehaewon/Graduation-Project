<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="resources/logo_white.png">

    <title>Style Transfer</title>

    <!-- Bootstrap core CSS -->
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="css/cover.css" type="text/css">

    <script type="text/javascript" src="dist/jquery/jquery-1.12.1.min.js"></script>
    <script src="js/connectionModule.js" type="text/javascript"></script>
    <!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
</head>

<body>
    <header class="mb-auto">
      <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="http://localhost:3000/"><img src="resources/ic_home.png" style="height: 24px;"></a>
      </nav>
    </header>

    <div class="cover-containerd-flex w-50 h-100 p-3 mx-auto flex-column text-center" style="width: 600px; margin-top: 200px;">
        <!-- Preloader with Bootstrap Progress Bar -->
        <img class="cover-image figure-image" src="resources/logo_color.png" style="height: 350px;" />
        <p class="lead text-muted" id="status"><strong>Content image를 분석하는 중..</strong></p>
        <div class="progress">
          <div class="progress-bar progress-bar-striped progress-bar-animated bg-warning" role="progressbar" id="bar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
        </div>
    </div>
    <script type="text/javascript">
        var val = 0;
        var bar = $("#bar");

        window.onload = function(){
            post_startAction('progress');
            var val = 0;
            var progress = setInterval(function(){
                changeProgress(val);
                val+=5;
                if(val == 100)
                    clearInterval(progress);
            }, 3000);
            // 여기에서 changeProgress(30) 같이 값 계속 받아오면 됨
        }

        function changeStatus(val){
            if(val >= 80) 
                $("#status").text("출력하는 중..");
            else if(val >= 50)
                $("#status").text("변환하는 중..");
            else if(val >= 30)
                $("#status").text("오브젝트를 추출하는 중..");
            else if(val >= 20)
                $("#status").text("Content image를 분석하는 중..");
        }

        function changeProgress(val){ // val : 0~100
            bar.attr('aria-valuenow', val);
            bar.text(val + "%");
            bar.width(val + "%");
            changeStatus(val);
        }        


        function success_sendStartAction() {            
            location.href="http://localhost:3000/result";
        }

        function fail_sendStartAction() {
            //alert("fail");
         }
    </script>

<!--    <script src="dist/jquery/jquery.min.js"></script>-->
    <script src="dist/js/bootstrap.bundle.min.js"></script>
    
    <script type="text/javascript" src="dist/jquery/jquery.xdomainajax.js"></script>
</body>

</html>